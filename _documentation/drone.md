---
layout: page
title:  "Testing in Drone"
cover-img: /assets/img/drone_splash.jpg
date:   2025-08-26 20:08:51 +0200
author: Guus der Kinderen
---

## Introduction

This guide is intended for XMPP Server developers who are building their server with Drone. It demonstrates how to add XMPP Interoperability and Standards Conformance tests integrated into a build & test pipeline. This assumes that you already have a pipeline established, and wish to add the additional checks.

The checks are executed within the pipeline by a plugin that we're providing. The only prerequisite is that you've got a built XMPP server and have started it (presumably as a background service)

Assuming that you have a pre-existing pipeline that build your server and starts it for integration testing, then adding our plugin is as easy as adding one step to your pipeline, like this:

{% highlight yaml %}

- name: runtests
  image: ghcr.io/xmpp-interop-testing/drone-xmpp-test:latest
  settings:
    host: xmppserver
    domain: shakespeare.lit

{% endhighlight %}

This example demonstrates one possible way to provision accounts. It assumes your server is running and reachable on the host `xmppserver`, serving the XMPP domain `shakespeare.lit`, and that it supports In-Band Registration (as defined in [XEP-0077](https://xmpp.org/extensions/xep-0077.html)) to provision accounts. Other configuration methods are also available, and you can explore the full set of options in the sections below.

## A Full Example

Drone relies heavily on containerization. The following example assumes that your pipeline is set up for building an XMPP server and making available the corresponding container image, called `myorg/xmppserver`"

To execute the tests from the XMPP Integration Testing Framework, the server needs to be running. That can be achieved by running your server as a [service](https://docs.drone.io/pipeline/docker/syntax/services/), as shown in this example:

{% highlight yaml %}

services:
- name: xmppserver
  image: myorg/xmppserver:latest

{% endhighlight %}

Service containers are reachable at a hostname identical to the container name. The host on which your XMPP service is running will match the `name` value of the step.

Optionally, include a check for the health of your xmppserver service (or add a 'sleep') to allow your service to fully boot up. Refer to the [Drone documentation](https://docs.drone.io/pipeline/docker/syntax/services/) for tips and tricks.

Next, you're ready to add a step that runs the XMPP Interop Framework Testing plugin.

{% highlight yaml %}

- name: runtests
  image: ghcr.io/xmpp-interop-testing/drone-xmpp-test:latest
  settings:
    host: xmppserver
    domain: shakespeare.lit
    adminAccountUsername: admin
    adminAccountPassword: admin
    enabledSpecifications: XEP-0115,XEP-0199,XEP-0352

{% endhighlight %}

The above assumes that your server is running and reachable on the host `xmppserver`, serving the XMPP domain `shakespeare.lit` and that it is provisioned with an administrative account (one that is allowed to create other users, per [XEP-0133](https://xmpp.org/extensions/xep-0133.html)) that uses the username `juliet` and the provided password. You'll find the full range of available configuration options below.

For completeness, here is the full pipeline, combining everything above:

{% highlight yaml %}

kind: pipeline
type: docker
name: default

steps:
- name: runtests
  image: ghcr.io/xmpp-interop-testing/drone-xmpp-test:latest
  settings:
    host: xmppserver
    domain: shakespeare.lit
    adminAccountUsername: admin
    adminAccountPassword: admin
    enabledSpecifications: XEP-0115,XEP-0199,XEP-0352

services:
- name: xmppserver
  image: myorg/xmppserver:latest

{% endhighlight %}

Drone does not make available the XMPP stanza logs that are generated by the XMPP Interop Framework plugin. To have access to these logs, which are very helpful to [diagnose test failures](/documentation/diagnose-test-failures), we are still in search of a good solution. Do you know of one? [Please let us know](/contact)!

## Configuration

Various options are available when calling _xmpp-interop-testing/drone-xmpp-test_, and whilst none of them are absolutely required, the defaults are unlikely to be perfect for everyone.

For the latest updates to the documentation of the configuration updates, consult the [GitHub repository of the Drone plugin](https://github.com/XMPP-Interop-Testing/xmpp-interop-tests-drone-plugin).

{% include doc-conf-table.html %}

{% include doc-conf-provision.html %}

{% include doc-next-steps.html %}

_Splash image courtesy of [Shahadat Rahman, Unsplash](https://unsplash.com/photos/shallow-focus-photography-of-computer-codes-BfrQnKBulYQ?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash)_
