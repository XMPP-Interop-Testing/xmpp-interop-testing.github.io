---
layout: page
title:  "Testing in Forgejo"
cover-img: /assets/img/forgejo_splash.png
date:   2025-09-01 22:14:14 +0200
author: Guus der Kinderen
---

## Introduction

This guide is intended for XMPP Server developers who are building on Forgejo Actions. It demonstrates how to add XMPP Interoperability and Standards Conformance tests integrated into a build & test pipeline. This assumes that you already have a pipeline established, and wish to add the additional checks.

The checks run as their own action within the pipeline, in which they'll execute tests and output debug logs. The only prerequisite is that you've got a built server and have started it.

Assuming that you have a pre-existing pipeline that build your server and starts it for integration testing, then adding our Forgejo Action is as easy as adding one step to your pipeline, like this:

{% highlight yaml %}

- name: Run XMPP Interoperability Tests against CI server.
  uses: https://codeberg.org/XMPP-Interop-Testing/xmpp-interop-tests-forgejo-action@v1.6.0
  with:
    domain: 'shakespeare.lit'
    adminAccountUsername: 'juliet'
    adminAccountPassword: 'O_Romeo_Romeo!'

{% endhighlight %}

The above assumes that your server is running and reachable on the domain `shakespeare.lit` and that it is provisioned with an administrative account (one that is allowed to create other users, per [XEP-0133](https://xmpp.org/extensions/xep-0133.html)) that uses the username `juliet` and the provided password. You'll find the full range of available configuration options below.

## A Full Example

The following example assumes that your pipeline is set up for building an XMPP server and making available the corresponding container image, called `myorg/xmppserver`"

To execute the tests from the XMPP Integration Testing Framework, the server needs to be running. That can be achieved by running your server as a [service](https://forgejo.org/docs/latest/user/actions/advanced-features/#services), as shown in this example:

{% highlight yaml %}

services:
  xmppserver:
    image: myorg/xmppserver:latest

{% endhighlight %}

The host on which your XMPP service is running will match the name of the service, `xmppserver` in the example above.

Next, you're ready to add a step that runs the XMPP Interop Framework Testing plugin.

{% highlight yaml %}

steps:
  - name: Run the XMPP Interop Tests
    uses: https://codeberg.org/XMPP-Interop-Testing/xmpp-interop-tests-forgejo-action@v1.6.0
    with:
      host: xmppserver
      domain: 'shakespeare.lit'
      adminAccountUsername: 'juliet'
      adminAccountPassword: 'O_Romeo_Romeo!'

{% endhighlight %}

The above assumes that your server is running and reachable on the host `xmppserver`, serving the XMPP domain `shakespeare.lit` and that it is provisioned with an administrative account (one that is allowed to create other users, per [XEP-0133](https://xmpp.org/extensions/xep-0133.html)) that uses the username `juliet` and the provided password. You'll find the full range of available configuration options below.

For completeness, here is the full pipeline, combining everything above:

{% highlight yaml %}

on: [push]
jobs:
  test:
    runs-on: codeberg-small
    services:
      xmppserver:
        image: myorg/xmppserver:latest
    steps:
      - name: Run the XMPP Interop Tests
        uses: https://codeberg.org/XMPP-Interop-Testing/xmpp-interop-tests-forgejo-action@v1.6.0
        with:
          host: xmppserver
          domain: 'shakespeare.lit'
          adminAccountUsername: 'juliet'
          adminAccountPassword: 'O_Romeo_Romeo!'

{% endhighlight %}

Forgejo does not give a detailed overview of what tests succeed, and what test failed (apart from the textual output in the console) but it does make available the XMPP stanza logs that are generated by the XMPP Interop Framework plugin. These are available as an artifact of the build.

## Configuration

Various options are available when calling _xmpp_interop_tests_action_, and whilst none of them are absolutely required, the defaults are unlikely to be perfect for everyone.

For the latest updates to the documentation of the configuration updates, consult the [Codeberg repository of the Forgejo plugin](https://codeberg.org/XMPP-Interop-Testing/xmpp-interop-tests-forgejo-action).

{% include doc-conf-table.html %}

{% include doc-conf-provision.html %}

{% include doc-next-steps.html %}

_Splash image courtesy of [David Revoy, Forgejo](https://www.peppercarrot.com/en/viewer/misc-src__2022-11-27_Forgejo_by-David-Revoy.html)_
